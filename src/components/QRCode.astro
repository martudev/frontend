---
const { qr } = Astro.props;
---

<div style="position: relative;">
  {
    qr && (
      <>
        <img src="/martu-face.jpg" draggable="false" />
        <canvas id="qr" data-qr={qr} />
      </>
    )
  }
</div>

<style>
  canvas {
    border-radius: 5%;
  }

  img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    position: absolute;
    left: 50%;
    margin-left: -25px;
    top: 50%;
    margin-top: -25px;
    border: 3px solid black;
  }
</style>

<script>
  import QRCode from "qrcode";

  const qrsCanvas = document.querySelectorAll("#qr");

  qrsCanvas.forEach((canvas) => {
    const dataQr = canvas?.getAttribute("data-qr");
    if (dataQr)
      QRCode.toCanvas(canvas, dataQr, function (error) {
        if (error) console.error(error);
        console.log("success!");
      });
  });
</script>
